<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tema do App - Admin</title>
    <link rel="stylesheet" href="css/styles.css">
    <script src="https://unpkg.com/@phosphor-icons/web"></script>
    <style>
        .theme-layout {
            display: grid;
            grid-template-columns: minmax(0, 2.2fr) minmax(0, 1.3fr);
            gap: 2rem;
            align-items: flex-start;
        }

        @media (max-width: 960px) {
            .theme-layout {
                grid-template-columns: minmax(0, 1fr);
            }
        }

        .theme-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
            gap: 1.5rem;
            margin-top: 1.5rem;
        }

        .theme-card {
            background: var(--bg-surface);
            border: 1px solid var(--border);
            border-radius: 16px;
            padding: 1.25rem;
            cursor: pointer;
            transition: var(--transition);
            position: relative;
            box-shadow: var(--shadow-sm);
        }

        .theme-card:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
            border-color: var(--primary-light);
        }

        .theme-card.active {
            border-color: var(--primary);
            box-shadow: 0 12px 30px rgba(79, 70, 229, 0.18);
        }

        .theme-card.active::after {
            content: 'Tema ativo';
            position: absolute;
            top: 12px;
            right: 12px;
            background: var(--success-soft);
            color: var(--success);
            padding: 4px 10px;
            border-radius: 999px;
            font-size: 0.72rem;
            font-weight: 600;
            letter-spacing: 0.03em;
        }

        .theme-preview {
            height: 120px;
            border-radius: 12px;
            margin-bottom: 1rem;
            position: relative;
            overflow: hidden;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #fff;
            font-weight: 600;
            font-size: 1.2rem;
        }

        .theme-preview-gradient {
            position: absolute;
            inset: 0;
            opacity: 0.2;
        }

        .theme-preview-content {
            position: relative;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            z-index: 1;
        }

        .theme-label {
            display: inline-flex;
            align-items: center;
            gap: 0.25rem;
            padding: 0.1rem 0.6rem;
            border-radius: 999px;
            font-size: 0.7rem;
            background: rgba(15, 23, 42, 0.18);
        }

        .theme-card h4 {
            font-size: 1rem;
            margin-bottom: 0.25rem;
        }

        .theme-card p {
            font-size: 0.85rem;
            color: var(--text-secondary);
        }

        .preview-nail {
            background: radial-gradient(circle at 0% 0%, #fecdd3 0%, #fb7185 40%, #831843 100%);
        }

        .preview-barber {
            background: radial-gradient(circle at 0% 0%, #1f2937 0%, #020617 45%, #fbbf24 100%);
        }

        .preview-hair {
            background: radial-gradient(circle at 0% 0%, #fef3c7 0%, #fde68a 40%, #92400e 100%);
            color: #111827;
        }

        .preview-spa {
            background: radial-gradient(circle at 0% 0%, #bbf7d0 0%, #22c55e 40%, #064e3b 100%);
        }

        .preview-tattoo {
            background: radial-gradient(circle at 0% 0%, #fca5a5 0%, #b91c1c 40%, #020617 100%);
        }

        .preview-health {
            background: radial-gradient(circle at 0% 0%, #bfdbfe 0%, #3b82f6 40%, #1e3a8a 100%);
        }

        .theme-sidebar-card {
            border-radius: 18px;
            padding: 1.5rem;
            background: linear-gradient(145deg, rgba(15, 23, 42, 0.98), rgba(30, 64, 175, 0.96));
            color: #e5e7eb;
            box-shadow: 0 18px 45px rgba(15, 23, 42, 0.55);
        }

        .theme-sidebar-card h3 {
            color: #e5e7eb;
            font-size: 1.1rem;
            margin-bottom: 0.5rem;
        }

        .theme-sidebar-card p {
            font-size: 0.85rem;
            color: #cbd5f5;
            margin-bottom: 1.25rem;
        }

        .theme-current-pill {
            display: inline-flex;
            align-items: center;
            gap: 0.4rem;
            padding: 0.35rem 0.85rem;
            border-radius: 999px;
            background: rgba(30, 64, 175, 0.25);
            color: #e5e7eb;
            font-size: 0.8rem;
            margin-bottom: 1rem;
        }

        .theme-badges {
            display: flex;
            flex-wrap: wrap;
            gap: 0.4rem;
        }

        .theme-badge {
            padding: 0.25rem 0.7rem;
            border-radius: 999px;
            border: 1px solid rgba(148, 163, 184, 0.5);
            font-size: 0.75rem;
            color: #e5e7eb;
        }

        .theme-footer-actions {
            display: flex;
            justify-content: flex-end;
            align-items: center;
            gap: 0.75rem;
            margin-top: 1.75rem;
        }

        .theme-footnote {
            font-size: 0.78rem;
            color: var(--text-muted);
        }
    </style>
</head>

<body>
    <div class="sidebar">
        <div class="brand">Admin Panel</div>
        <nav class="nav-links">
            <a href="index.html" class="nav-link"><i class="ph-duotone ph-squares-four icon-dashboard"></i>
                Dashboard</a>
            <a href="financials.html" class="nav-link"><i class="ph-duotone ph-chart-line-up icon-finance"></i>
                Financeiro</a>
            <a href="users.html" class="nav-link"><i class="ph-duotone ph-users-three icon-users"></i> Clientes</a>
            <a href="appointments.html" class="nav-link"><i class="ph-duotone ph-calendar-check icon-appointments"></i>
                Agendamentos</a>
            <a href="services.html" class="nav-link"><i class="ph-duotone ph-sparkle icon-services"></i> Serviços</a>
            <a href="promotions.html" class="nav-link"><i class="ph-duotone ph-tag icon-promo"></i> Promoções</a>
            <a href="schedule-settings.html" class="nav-link"><i class="ph-duotone ph-clock icon-time"></i> Horários</a>
            <a href="notifications-admin.html" class="nav-link"><i class="ph-duotone ph-bell-ringing icon-bell"></i>
                Notificações</a>
            <a href="settings.html" class="nav-link"><i class="ph-duotone ph-trophy icon-game"></i> Gamificação</a>
            <a href="theme.html" class="nav-link active"><i class="ph-duotone ph-paint-brush icon-theme"></i>
                Aparência</a>
        </nav>
    </div>
    <div class="sidebar-overlay"></div>

    <div class="main">
        <div class="header" style="margin-bottom: 1.75rem;">
            <div style="display: flex; align-items: center; gap: 10px;">
                <button id="sidebarToggle" class="btn-icon" style="display: none; font-size: 1.5rem;">
                    <i class="ph-duotone ph-list"></i>
                </button>
                <div>
                    <h1>Aparência do Aplicativo</h1>
                    <p style="color: var(--text-light); margin-top: 4px;">Escolha o tema que mais combina com o seu
                        negócio.</p>
                </div>
            </div>
        </div>

        <div class="card-modern">
            <div class="theme-layout">
                <div>
                    <h3 style="margin-bottom: 0.75rem; color: var(--text-main);">Selecione um tema</h3>
                    <p style="color: var(--text-secondary); font-size: 0.9rem; margin-bottom: 0.75rem;">
                        Isso altera as cores e o estilo visual do aplicativo que o cliente enxerga.
                    </p>
                    <p style="color: var(--text-muted); font-size: 0.8rem;">
                        A mudança é aplicada para todos os dispositivos em poucos segundos.
                    </p>

                    <div class="theme-grid" id="themeGrid">
                        <div class="theme-card active" data-theme="nail" onclick="selectTheme('nail', this)">
                            <div class="theme-preview preview-nail">
                                <div class="theme-preview-gradient"></div>
                                <div class="theme-preview-content">
                                    <i class="ph-duotone ph-hand-soap" style="font-size: 2rem;"></i>
                                    <div>
                                        <div>Esmalteria</div>
                                        <div class="theme-label">
                                            <span>Rosa sofisticado</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <h4>Esmalteria / Unhas</h4>
                            <p>Tons delicados de rosa, sensação moderna e feminina.</p>
                        </div>

                        <div class="theme-card" data-theme="barber" onclick="selectTheme('barber', this)">
                            <div class="theme-preview preview-barber">
                                <div class="theme-preview-gradient"></div>
                                <div class="theme-preview-content">
                                    <i class="ph-duotone ph-scissors" style="font-size: 2rem;"></i>
                                    <div>
                                        <div>Barbearia</div>
                                        <div class="theme-label">
                                            <span>Escuro premium</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <h4>Barbearia Clássica</h4>
                            <p>Preto, dourado e contraste alto, com cara de clube masculino.</p>
                        </div>

                        <div class="theme-card" data-theme="hair" onclick="selectTheme('hair', this)">
                            <div class="theme-preview preview-hair">
                                <div class="theme-preview-gradient"></div>
                                <div class="theme-preview-content">
                                    <i class="ph-duotone ph-sparkle" style="font-size: 2rem;"></i>
                                    <div>
                                        <div>Salão Gold</div>
                                        <div class="theme-label">
                                            <span>Luxo clean</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <h4>Salão Gold</h4>
                            <p>Branco, dourado e layout iluminado para salões premium.</p>
                        </div>

                        <div class="theme-card" data-theme="spa" onclick="selectTheme('spa', this)">
                            <div class="theme-preview preview-spa">
                                <div class="theme-preview-gradient"></div>
                                <div class="theme-preview-content">
                                    <i class="ph-duotone ph-plant" style="font-size: 2rem;"></i>
                                    <div>
                                        <div>Spa & Relax</div>
                                        <div class="theme-label">
                                            <span>Verde calma</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <h4>Spa & Estética</h4>
                            <p>Paleta suave em verde água para clínicas e spas.</p>
                        </div>

                        <div class="theme-card" data-theme="tattoo" onclick="selectTheme('tattoo', this)">
                            <div class="theme-preview preview-tattoo">
                                <div class="theme-preview-gradient"></div>
                                <div class="theme-preview-content">
                                    <i class="ph-duotone ph-pen-nib" style="font-size: 2rem;"></i>
                                    <div>
                                        <div>Estúdio Tattoo</div>
                                        <div class="theme-label">
                                            <span>Preto intenso</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <h4>Estúdio Tattoo</h4>
                            <p>Preto, vermelho escuro e clima de estúdio urbano.</p>
                        </div>

                        <div class="theme-card" data-theme="health" onclick="selectTheme('health', this)">
                            <div class="theme-preview preview-health">
                                <div class="theme-preview-gradient"></div>
                                <div class="theme-preview-content">
                                    <i class="ph-duotone ph-heartbeat" style="font-size: 2rem;"></i>
                                    <div>
                                        <div>Clínica</div>
                                        <div class="theme-label">
                                            <span>Azul profissional</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <h4>Saúde & Clínica</h4>
                            <p>Azul claro e branco, com visual mais clínico e confiável.</p>
                        </div>
                    </div>
                </div>

                <div class="theme-sidebar-card">
                    <div class="theme-current-pill">
                        <i class="ph-duotone ph-monitor-play" style="font-size: 1rem;"></i>
                        <span id="currentThemeLabel">Tema atual: Manicure</span>
                    </div>
                    <h3>Pré-visualização do aplicativo</h3>
                    <p>
                        Use esta área para entender rapidamente como o app do cliente irá se comportar
                        com o tema escolhido. A experiência é otimizada para celular.
                    </p>

                    <div class="theme-badges" style="margin-bottom: 1.25rem;">
                        <span class="theme-badge">App do cliente</span>
                        <span class="theme-badge">Cores e botões</span>
                        <span class="theme-badge">Dark / Light</span>
                    </div>

                    <p style="font-size: 0.8rem; color: #cbd5f5;">
                        Após salvar, basta o cliente abrir o app ou atualizar a página para ver o novo visual.
                    </p>
                </div>
            </div>

            <div class="theme-footer-actions">
                <span class="theme-footnote">
                    Ao salvar, o tema é sincronizado com todos os clientes conectados.
                </span>
                <button onclick="saveTheme()" class="btn btn-primary" style="padding: 0.85rem 2.2rem; max-width: 240px;">
                    <i class="ph-bold ph-check"></i> Salvar tema do aplicativo
                </button>
            </div>
            <div id="statusMessage" style="margin-top: 1rem; display: none;" class="alert"></div>
        </div>
    </div>

    <script src="../client/js/api.js"></script>
    <script src="js/layout.js"></script>
    <script>
        let currentTheme = 'nail';

        document.addEventListener('DOMContentLoaded', async () => {
            try {
                const settings = await api.get('/admin/settings');
                if (settings && settings.client_theme) {
                    currentTheme = settings.client_theme;
                }
            } catch (e) {
            }
            updateUI(currentTheme);
        });

        function selectTheme(themeId, cardElement) {
            currentTheme = themeId;
            updateUI(themeId);
        }

        function updateUI(activeThemeId) {
            document.querySelectorAll('.theme-card').forEach(card => {
                card.classList.remove('active');
            });
            const cards = document.querySelectorAll('.theme-card');
            cards.forEach(card => {
                if (card.getAttribute('data-theme') === activeThemeId) {
                    card.classList.add('active');
                }
            });
            const label = document.getElementById('currentThemeLabel');
            if (label) {
                if (activeThemeId === 'nail') label.textContent = 'Tema atual: Manicure';
                if (activeThemeId === 'barber') label.textContent = 'Tema atual: Barbearia';
                if (activeThemeId === 'hair') label.textContent = 'Tema atual: Salão Gold';
                if (activeThemeId === 'spa') label.textContent = 'Tema atual: Spa & Estética';
                if (activeThemeId === 'tattoo') label.textContent = 'Tema atual: Estúdio Tattoo';
                if (activeThemeId === 'health') label.textContent = 'Tema atual: Saúde & Clínica';
            }
        }

        async function saveTheme() {
            try {
                await api.post('/admin/settings', { client_theme: currentTheme });
                showMessage('Tema atualizado com sucesso!', 'success');
            } catch (err) {
                showMessage('Erro ao salvar tema: ' + err.message, 'error');
            }
        }

        function showMessage(text, type) {
            const msg = document.getElementById('statusMessage');
            msg.textContent = text;
            msg.className = `alert alert-${type}`;
            msg.style.display = 'block';
            setTimeout(() => msg.style.display = 'none', 3000);
        }
    </script>
</body>

</html>
